### [Переведенная оригинальная документация](https://nmap.org/man/ru/)
#### **Состояния портов:**
- **Open** - цель отвечает, порт открыт извне
  Пример: **22/tcp open ssh** - на порт приходит tcp/udp хендшейк, есть сервис, принимающий соединения.
- **Closed** - цель отвечает, порт закрыт извне
  Пример: **80/tcp closed http** - сервер отвечает, но сервиса нет.
- **Filtered** - подтверждение не получено (RST/CYN), пакеты блокируются фильтром или фаерволом.
  Пример: **53/udp filtered domain**
- **Unfiltered** - порт отвечает, но статус сервиса не ясен, зачастую бывает при сложных режимах настройки фаервола)
- **Open|Filtered** - не получается различить открытый порт или фильтруется, нужно пробовать другие способы сканирования
  Пример: **123/udp open|filtered ntp**
- **Closed|Filtered** - аналогично с Open|Filtered
```shell
#Общий вид команд
nmap [Тип сканирования...] [Опции] {цель сканирования} - общий вид команд

nmap 192.168.1.1 - скан отдельного IP-адреса
nmap example.com - скан сервера по имени хоста
--------------------------------------------------------------------------------
#Повышение уровня детализации
nmap -v example.com
nmap -vv example.com
--------------------------------------------------------------------------------
#Скан множества IP-адресов
nmap 192.168.1.1 192.168.1.2 192.168.1.3
nmap 192.168.1.1,2,3
nmap 192.168.1.1-3
#Ну или можно из заготовленного файла
nmap -iL targets.txt
#Скан подсети
nmap 192.168.1.0/24
nmap 192.168.1.*
--------------------------------------------------------------------------------
#Поиск активных хостов в сети
nmap -sn 192.168.1.0/24
--------------------------------------------------------------------------------
#Исключения в сканировании
nmap 192.168.1.0/24 --exclude 192.168.1.1
nmap 192.168.1.0/24 --excludefile targets.txt
--------------------------------------------------------------------------------
#Скан портов
nmap -p 80 example.com
nmap -p 80,443 example.com - множество
nmap -p 80-1000 example.com - диапазон
nmap -p "*" example.com - все порты
#Скан самых распространенных портов
nmap --top-ports 5 example.com
nmap --top-ports 10 example.com
--------------------------------------------------------------------------------
#Сканирование портов определенных протоколов
nmap -sT example.com - TCP-порты
nmap -p T:80 example.com - скан определенного TCP-порта
nmap -sU example.com - UDP-порты
nmap -p U:80 example.com - скан определенного UDP-порта
--------------------------------------------------------------------------------
#Управление скоростью сканирования
Есть 6 шаблонов управления временем: paranoid(0), sneaky(1), polite(2), normal(3), aggressive(4) и insane(5).

nmap -T4 example.com
--------------------------------------------------------------------------------
#Дополнительные аргументы
nmap -p T:80 --reason example.com - показать причину состояния порта
nmap --open example.com - показать только открытые порты
#Определение ОС
nmap -O example.com
#Определение версии сервисов на сервере
nmap -sV example.com
#Определение имени сетевого узла
nmap -sL example.com
#Определение защиты пакетными фильтрами или фаерволами на сервере
nmap -sA example.com
#Подмена MAC адреса в локальной сети
nmap --spoof-mac 00:11:22:33:44:55 example.com
nmap --spoof-mac 0 example.com - подмена на случайный MAC
--------------------------------------------------------------------------------
#Cканирование фаервола на уязвимости
Эти три сканирования используют лазейку в TCP RFC, чтобы разделять порты на открытые и закрытые:
Любой пакет, не содержащий установленного бита SYN, RST или ACK, повлечет за собой отправку RST в ответ в случае, если порт закрыт, или не повлечет никакого ответа, если порт открыт.
Так как ни один из этих битов не установлен, то любая комбинация трех оставшихся (FIN, PSH, URG) будет являться правильной.

#TCP Null сканирование - отправляется пакет без установленных TCP-флагов:
nmap -sN example.com
#TCP Fin сканирование - отправляется пакет с FIN-флагом:
nmap -sF example.com
#TCP Xmas сканирование - отправляется пакет с флагами FIN, PSH и URG:
nmap -sX example.com

#Скрытое сканирование
TCP SYN - используются полуоткрытые соединения
nmap -sS example.com
#Отключение обнаружение хостов (NoPing) - хосты не пингуются перед сканированием:
nmap -Pn example.com
#Отключение использования DNS:
nmap -n 192.168.1.1
--------------------------------------------------------------------------------
#Сохранение результатов в файл:
В текстовый файл:
	nmap example.com > output.txt
	nmap -oN output.txt example.com
В XML файл:
	nmap -oX output.xml example.com
--------------------------------------------------------------------------------
#Скрипты
У nmap есть свой набор скриптов, которые способны дать определённую информацию при сканировании. Они делятся на следующие типы: safe, (intrusive), malware, version, discovery, vuln, auth и default. Что бы при сканировании работал какой — то конкретный скрипт или группа скриптов, то следует запускать с ключом —script.

nmap --script <категории - скриптов>|<директория>|<имя_файла>|all example.com

Также, возможно, некоторым скриптам нужно передавать значения. Это делается следующим образом: —script-args <имя1>=<значение1>, <имя2>={<имя3>=<значение3>}, <имя4>=<значение4>. Данные скрипты позволяют выполнять параллельные действия над сканируемыми сетевыми портами.
```
#### **Дополнительная информация:**
- `TCP` ACK сканирование (`-sA`): данный тип сканирование направлен на изучение особенностей реагирования `Firewall`. Если `порт не` фильтруется, то будет возвращаться `TCP` ответ с флагом RST.
- `TCP` Window сканирование (`-sW`): данный тип сканирование похож сутью работы на `TCP` ACK, но при этом способен определять, закрыт или открыт порт за счёт анализа поля `TCP` Window в RST ответе. В некоторых системах открытые `порты` используют положительное значение этого поля (даже в RST пакетах), а закрытые — нулевое.
- `TCP` сканирование Мэймона (`-sM`): этот тип сканирования носит имя своего первооткрывателя, Уриела Мэймона. Техника практически такая же, как и при NULL, FIN и Xmas сканированиях, только в качестве запросов используются запросы FIN/ACK. Согласно RFC 793 (`TCP`), в ответ на такой запрос должен быть сгенерирован RST пакет, если порт открыт или закрыт. Однако многие BSD системы просто отбрасывают пакет, если порт открыт.
- Зомби сканирование (`-sI`): данный метод сканирование позволяет полностью анонимно просканировать узел на информацию о состояние портов, так как сканирование происходит от лица другого узла.
- FTP bounce сканирование (-b): данный метод сканирования основан на возможности одного FTP сервера обмениваться файлами с другим FTP сервером. Этот метод позволяет достигнуть анонимности, но сейчас крайне мало шансов, что он сработает, так как многие FTP сервера переконфигурированы так, что они не могут отправлять между собой файлы